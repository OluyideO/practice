Type: AWS::IAM::Role
Properties:
  AssumeRolePolicyDocument:
    Statement:
      - Action:
          - 'sts:AssumeRole'
        Effect: 'Allow'
        Principal:
          Service:
            - 'codebuild.amazonaws.com'
    Version: '2012-10-17'
  Path: /
  Policies:
    - PolicyName: 'CodeBuildAccess'
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Action:
              - 'apigateway:*'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'cloudformation:CancelUpdateStack'
              - 'cloudformation:ContinueUpdateRollback'
              - 'cloudformation:CreateChangeSet'
              - 'cloudformation:CreateStack'
              - 'cloudformation:CreateUploadBucket'
              - 'cloudformation:CancelUpdateStack'
              - 'cloudformation:CreateChangeSet'
              - 'cloudformation:DeleteStack'
              - 'cloudformation:DeleteStackInstances'
              - 'cloudformation:DescribeAccountLimits'
              - 'cloudformation:DescribeChangeSet'
              - 'cloudformation:DescribeStackEvents'
              - 'cloudformation:DescribeStackInstance'
              - 'cloudformation:DescribeStackResource'
              - 'cloudformation:DescribeStackResources'
              - 'cloudformation:DescribeStacks'
              - 'cloudformation:DescribeStackSet'
              - 'cloudformation:DescribeStackSetOperation'
              - 'cloudformation:EstimateTemplateCost'
              - 'cloudformation:ExecuteChangeSet'
              - 'cloudformation:GetStackPolicy'
              - 'cloudformation:GetTemplate'
              - 'cloudformation:GetTemplateSummary'
              - 'cloudformation:ListChangeSets'
              - 'cloudformation:ListExports'
              - 'cloudformation:ListImports'
              - 'cloudformation:ListStackInstances'
              - 'cloudformation:ListStackResources'
              - 'cloudformation:ListStacks'
              - 'cloudformation:ListStackSetOperationResults'
              - 'cloudformation:ListStackSetOperations'
              - 'cloudformation:ListStackSets'
              - 'cloudformation:UpdateTerminationProtection'
              - 'cloudformation:UpdateStack'
              - 'cloudformation:ValidateTemplate'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'cloudwatch:*'
            Resource: '*'
            Effect: 'Allow'
          - Action:
              - 'dynamodb:CreateTable'
              - 'dynamodb:DeleteItem'
              - 'dynamodb:DeleteTable'
              - 'dynamodb:DescribeContinuousBackups'
              - 'dynamodb:DescribeTable'
              - 'dynamodb:DescribeTimeToLive'
              - 'dynamodb:GetItem'
              - 'dynamodb:PutItem'
              - 'dynamodb:Query'
              - 'dynamodb:Scan'
              - 'dynamodb:UpdateContinuousBackups'
              - 'dynamodb:UpdateItem'
              - 'dynamodb:UpdateTimeToLive'
            Resource: '*'
            Effect: 'Allow'
          - Action:
              - 'ec2:CreateNetworkInterface'
              - 'ec2:CreateNetworkInterfacePermission'
              - 'ec2:DescribeDhcpOptions'
              - 'ec2:DescribeNetworkInterfaces'
              - 'ec2:DeleteNetworkInterface'
              - 'ec2:DescribeSubnets'
              - 'ec2:DescribeSecurityGroups'
              - 'ec2:DescribeVpcs'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'events:DescribeRule'
              - 'events:DeleteRule'
              - 'events:PutRule'
              - 'events:PutTargets'
              - 'events:RemoveTargets'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'iam:AttachRolePolicy'
              - 'iam:CreatePolicy'
              - 'iam:CreateRole'
              - 'iam:DeletePolicy'
              - 'iam:DeleteRole'
              - 'iam:DeleteRolePolicy'
              - 'iam:DetachRolePolicy'
              - 'iam:GetAccountAuthorizationDetails'
              - 'iam:GetGroup'
              - 'iam:GetGroupPolicy'
              - 'iam:GetPolicy'
              - 'iam:GetPolicyVersion'
              - 'iam:GetRole'
              - 'iam:GetRolePolicy'
              - 'iam:GetUser'
              - 'iam:GetUserPolicy'
              - 'iam:ListPolicyVersions'
              - 'iam:PassRole'
              - 'iam:PutRolePolicy'
              - 'iam:RemoveRoleFromInstanceProfile'
              - 'iam:UpdateRoleDescription'
              - 'iam:UpdateUser'
              - 'iam:UpdateRole'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'lambda:*'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'logs:*'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'route53:ListHostedZones'
            Resource: '*'
            Effect: Allow
          - Action:
              - 's3:CreateBucket'
              - 's3:DeleteBucket'
              - 's3:GetBucketLocation'
              - 's3:GetBucketVersioning'
              - 's3:GetEncryptionConfiguration'
              - 's3:GetObject'
              - 's3:GetObjectVersion'
              - 's3:ListBucket'
              - 's3:PutEncryptionConfiguration'
              - 's3:PutLifecycleConfiguration'
              - 's3:PutObject'
              - 's3:SetBucketEncryption'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'sns:*'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'ssm:GetParameter'
              - 'ssm:GetParameters'
              - 'ssm:List*'
            Resource: '*'
            Effect: Allow
          - Action:
              - 'waf-regional:AssociateWebACL'
              - 'waf-regional:DisassociateWebACL'
            Resource: '*'
            Effect: Allow